(function(t){function e(e){for(var r,a,o=e[0],c=e[1],l=e[2],d=0,m=[];d<o.length;d++)a=o[d],n[a]&&m.push(n[a][0]),n[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(m.length)m.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var t,e=0;e<i.length;e++){for(var s=i[e],r=!0,o=1;o<s.length;o++){var c=s[o];0!==n[c]&&(r=!1)}r&&(i.splice(e--,1),t=a(a.s=s[0]))}return t}var r={},n={app:0},i=[];function a(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=r,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(s,r,function(e){return t[e]}.bind(null,r));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;i.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"51f7":function(t,e,s){"use strict";var r=s("f241"),n=s.n(r);n.a},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var r=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},i=[],a={name:"app"},o=a,c=(s("51f7"),s("2877")),l=Object(c["a"])(o,n,i,!1,null,null,null),u=l.exports,d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login"},[s("logo"),s("font-awesome-icon",{class:{"spinning-vinyl":!0,spinning:t.isSpinning||t.forceSpinning},attrs:{icon:["fal","compact-disc"]}}),s("h3",{directives:[{name:"show",rawName:"v-show",value:t.forceSpinning,expression:"forceSpinning"}]},[t._v("Looking up "+t._s(t.discogsUsername)+"...")]),s("br"),s("div",{staticClass:"options"},[s("div",{staticClass:"connect-discogs button",on:{mouseover:function(e){t.isSpinning=!0},mouseleave:function(e){t.isSpinning=!1}}},[s("font-awesome-icon",{attrs:{icon:"compact-disc"}}),t._v(" Connect Discogs\n        ")],1),s("div",{staticClass:"or"},[t._v("\n            OR\n        ")]),s("div",{staticClass:"discogs-username"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.discogsUsername,expression:"discogsUsername"}],attrs:{placeholder:"Discogs Username",type:"text",name:"discogs-username"},domProps:{value:t.discogsUsername},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitForm(e)},function(e){t.isSpinning=!1}],keydown:function(e){t.isSpinning=!0},input:function(e){e.target.composing||(t.discogsUsername=e.target.value)}}})])])],1)},m=[],p=(s("96cf"),s("3b8d")),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h1",{staticClass:"logo"},[t._v("Spin Vinyl")])},g=[],f={name:"logo"},v=f,y=(s("ff89"),Object(c["a"])(v,h,g,!1,null,"5298961e",null)),b=y.exports,w=s("2f62"),k=s("bc3a"),C=s.n(k),_={getMaster:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,C.a.get("https://api.discogs.com/releases/"+e+"?token=RUWgPYGkypLztPqcshEmvlmtDXMJOsGUhEZEyKHY");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),getCollection:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,s,r,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,C.a.get("https://api.discogs.com/users/"+e+"/collection/folders/0/releases?per_page=10000&oauth_token="+s+"&oauth_token_secret="+r+"&page="+n+"&token=RUWgPYGkypLztPqcshEmvlmtDXMJOsGUhEZEyKHY");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e,s,r,n){return t.apply(this,arguments)}return e}()},A={name:"home",data:function(){return{discogsUsername:"",isSpinning:!1,forceSpinning:!1}},components:{Logo:b},methods:{submitForm:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.forceSpinning=!0,this.$store.commit("discogs/setDiscogsName",{username:this.discogsUsername}),e=1,t.prev=3,t.next=6,_.getCollection(this.$store.state.discogs.discogsUsername,this.$store.state.discogs.discogsOauthToken,this.$store.state.discogs.discogsOauthSecret,e);case 6:s=t.sent,t.next=13;break;case 9:return t.prev=9,t.t0=t["catch"](3),"Request failed with status code 404"===t.t0.message&&(alert("Username "+this.discogsUsername+" not found"),this.discogsUsername="",this.forceSpinning=!1),t.abrupt("return");case 13:if(!(void 0!==s.data.releases&&s.data.releases.length>0&&s.data.releases.length%500===0)){t.next=27;break}return e+=1,t.prev=15,t.next=18,_.getCollection(this.$store.state.discogs.discogsUsername,this.$store.state.discogs.discogsOauthToken,this.$store.state.discogs.discogsOauthSecret,e);case 18:s=t.sent,t.next=24;break;case 21:return t.prev=21,t.t1=t["catch"](15),t.abrupt("break",27);case 24:this.$store.commit("discogs/addToDiscogsCollection",{additions:s.data.releases}),t.next=13;break;case 27:this.$store.commit("discogs/setDiscogsCollection",{collection:s.data.releases}),this.$router.push("/random-album");case 29:case"end":return t.stop()}},t,this,[[3,9],[15,21]])}));function e(){return t.apply(this,arguments)}return e}()},computed:Object(w["b"])({storeDiscogsName:function(t){return t.discogs.discogsUsername}})},x=A,$=Object(c["a"])(x,d,m,!1,null,"17c0edf0",null),D=$.exports,S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return void 0!==t.master.id?s("div",{class:{listen:!0,light:t.shouldBeLight},style:t.cssProps},[s("div",{staticClass:"details"},[s("div",{staticClass:"image"},[s("img",{attrs:{src:t.master.images[0].uri}}),s("h1",[t._v(t._s(t.master.title))]),s("h3",[t._v(t._s(t.master.artists[0].name))])]),s("div",{staticClass:"tracks"},t._l(t.master.tracklist,function(e,r){return s("div",{key:e.position,class:{track:!0,highlighted:t.isCurrentTrack(r)}},[s("div",{staticClass:"title"},[t._v("\n                    "+t._s(e.position)+": "+t._s(e.title)+"\n                ")]),s("div",{staticClass:"duration"},[t._v("\n                    "+t._s(e.duration)+"\n                ")])])}),0)]),s("footer",{staticClass:"sticky-footer"},[s("a",{staticClass:"button",on:{click:t.newAlbum}},[t._v("\n            New Album\n        ")]),s("div",{staticClass:"progress-bar"},[s("div",{staticClass:"time-string"},[t._v(t._s(t.timeString))]),s("div",{staticClass:"ui"},[s("div",{staticClass:"position",style:{"margin-left":t.progressMargin}}),s("div",{staticClass:"bar"})])]),s("div",{staticClass:"controls"},[s("font-awesome-icon",{staticClass:"smaller",attrs:{icon:["fal","undo-alt"]},on:{click:t.reverse}}),s("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],attrs:{icon:["fal","play-circle"]},on:{click:t.startProgress}}),s("font-awesome-icon",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],attrs:{icon:["fal","pause-circle"]},on:{click:t.stopProgress}}),s("font-awesome-icon",{staticClass:"smaller",attrs:{icon:["fal","redo-alt"]},on:{click:t.forward}})],1)])]):t._e()},O=[];s("28a5"),s("c5f6"),s("a481"),s("4917");function B(t){var e,s,r,n;return t.match(/^rgb/)?(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),e=t[1],s=t[2],r=t[3]):(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")),e=t>>16,s=t>>8&255,r=255&t),n=Math.sqrt(e*e*.299+s*s*.587+r*r*.114),n>127.5?"light":"dark"}Number.prototype.pad=function(t){var e=String(this);while(e.length<(t||2))e="0"+e;return e};var P={name:"listening",data:function(){return{shouldBeLight:!1,gradient:{primary:"#DBD5A4",secondary:"#649173"},playing:!0,gradients:[{primary:"#B993D6",secondary:"#8CA6DB"},{primary:"#870000",secondary:"#190A05"},{primary:"#00d2ff",secondary:"#3a7bd5"},{primary:"#D3959B",secondary:"#BFE6BA"},{primary:"#DAD299",secondary:"#B0DAB9"},{primary:"#f2709c",secondary:"#ff9472"},{primary:"#E6DADA",secondary:"#274046"},{primary:"#DBD5A4",secondary:"#649173"},{primary:"#5D4157",secondary:"#A8CABA"}],master:{},progress:null,secondsCountdown:0,totalSeconds:0}},methods:{reverse:function(){this.secondsCountdown+=3e4,this.secondsCountdown>this.totalSeconds&&(this.secondsCountdown=this.totalSeconds)},forward:function(){this.secondsCountdown-=3e4},newAlbum:function(){this.$router.push("/random-album")},isCurrentTrack:function(t){for(var e=0,s=0,r=0;r<this.master.tracklist.length;r++)if(void 0!=this.master.tracklist[r].duration.split(":")[1]){if(r===t){s+=60*parseInt(this.master.tracklist[r].duration.split(":")[0]),s+=parseInt(this.master.tracklist[r].duration.split(":")[1]);break}e+=60*parseInt(this.master.tracklist[r].duration.split(":")[0]),e+=parseInt(this.master.tracklist[r].duration.split(":")[1]),s+=60*parseInt(this.master.tracklist[r].duration.split(":")[0]),s+=parseInt(this.master.tracklist[r].duration.split(":")[1])}if(s<=0)return!1;e*=1e3,s*=1e3;var n=this.totalSeconds-this.secondsCountdown;return n>=e&&n<=s},startProgress:function(){var t=this;this.playing=!0,this.progress=setInterval(function(){t.secondsCountdown=t.secondsCountdown-100,t.secondsCountdown<=0&&(clearInterval(t.progress),t.$router.push("/random-album"))},100)},stopProgress:function(){this.playing=!1,clearInterval(this.progress)}},computed:Object.assign({progressMargin:function(){return 100-this.secondsCountdown/this.totalSeconds*100+"%"},timeString:function(){var t=this.totalSeconds/1e3,e=(t-t%60)/60,s=t%60,r=parseInt(this.secondsCountdown/1e3),n=(r-r%60)/60,i=r%60;return n.pad(2)+":"+i.pad(2)+" / "+e.pad(2)+":"+s.pad(2)}},Object(w["b"])({cssProps:function(t){return{"--gradient-primary":t.randomvinyl.colors[0],"--gradient-secondary":t.randomvinyl.colors[1]}}})),mounted:function(){if(0!==this.$store.state.discogs.collection.length){for(var t=this.$store.state.discogs.masters,e=0;e<t.length;e++)if(t[e].id==this.$route.params.id){this.master=t[e];break}var s=0;for(e=0;e<this.master.tracklist.length;e++)void 0!=this.master.tracklist[e].duration.split(":")[1]&&(s+=60*parseInt(this.master.tracklist[e].duration.split(":")[0]),s+=parseInt(this.master.tracklist[e].duration.split(":")[1]));this.totalSeconds=1e3*s,this.secondsCountdown=this.totalSeconds,s>0&&this.startProgress();var r=B(this.cssProps["--gradient-primary"]),n=B(this.cssProps["--gradient-secondary"]);"dark"!==r&&"dark"!==n||(this.shouldBeLight=!0)}else this.$router.push("/")}},j=P,M=Object(c["a"])(j,S,O,!1,null,"27b7d7db",null),U=M.exports,R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return void 0!==t.selectedAlbum.basic_information?s("div",{class:{"random-album":!0,light:t.shouldBeLight},style:t.cssProps},[s("img",{attrs:{src:t.selectedAlbum.basic_information.cover_image}}),s("font-awesome-icon",{class:{spinner:!0,visible:t.isSpinning},attrs:{icon:["fal","compact-disc"]}}),s("h1",[t._v(t._s(t.selectedAlbum.basic_information.title))]),s("h3",[t._v(" "+t._s(t.selectedAlbum.basic_information.artists[0].name))]),s("br"),s("div",{staticClass:"button try-again",on:{click:t.tryAgain}},[t._v("\n        Try again\n    ")]),s("div",{staticClass:"button select",on:{click:t.listen}},[t._v("\n        Start Listening\n    ")])],1):t._e()},E=[],I={getColorsForImage:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",C.a.get("http://74.207.229.81:8081/colors?image_url="+e));case 1:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()};function L(t){var e,s,r,n;return t.match(/^rgb/)?(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),e=t[1],s=t[2],r=t[3]):(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")),e=t>>16,s=t>>8&255,r=255&t),n=Math.sqrt(e*e*.299+s*s*.587+r*r*.114),n>127.5?"light":"dark"}var T={name:"random-album",data:function(){return{selectedAlbum:{},isSpinning:!1,gradients:[{primary:"#B993D6",secondary:"#8CA6DB"},{primary:"#870000",secondary:"#190A05"},{primary:"#00d2ff",secondary:"#3a7bd5"},{primary:"#D3959B",secondary:"#BFE6BA"},{primary:"#DAD299",secondary:"#B0DAB9"},{primary:"#f2709c",secondary:"#ff9472"},{primary:"#E6DADA",secondary:"#274046"},{primary:"#DBD5A4",secondary:"#649173"},{primary:"#5D4157",secondary:"#A8CABA"}],gradient:{primary:"#DBD5A4",secondary:"#649173"},shouldBeLight:!1}},computed:Object(w["b"])({cssProps:function(t){return{"--gradient-primary":t.randomvinyl.colors[0],"--gradient-secondary":t.randomvinyl.colors[1]}}}),methods:{tryAgain:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.gradient=this.gradients[Math.floor(Math.random()*this.gradients.length)],this.selectedAlbum=this.$store.state.discogs.collection[Math.floor(Math.random()*this.$store.state.discogs.collection.length)],t.next=4,I.getColorsForImage(this.selectedAlbum.basic_information.cover_image);case 4:e=t.sent,this.$store.commit("randomvinyl/setCurrentColors",e.data),s=L(this.cssProps["--gradient-primary"]),r=L(this.cssProps["--gradient-secondary"]),console.log(s,r),this.shouldBeLight="dark"===s||"dark"===r;case 10:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),listen:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.isSpinning=!0,t.next=3,_.getMaster(this.selectedAlbum.basic_information.id);case 3:e=t.sent,this.$store.commit("discogs/addMaster",{master:e.data}),this.$router.push("/listen/"+e.data.id);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.$store.state.discogs.collection.length){t.next=3;break}return this.$router.push("/"),t.abrupt("return");case 3:return this.gradient=this.gradients[Math.floor(Math.random()*this.gradients.length)],this.selectedAlbum=this.$store.state.discogs.collection[Math.floor(Math.random()*this.$store.state.discogs.collection.length)],t.next=7,I.getColorsForImage(this.selectedAlbum.basic_information.cover_image);case 7:e=t.sent,this.$store.commit("randomvinyl/setCurrentColors",e.data),s=L(this.cssProps["--gradient-primary"]),r=L(this.cssProps["--gradient-secondary"]),"dark"!==s&&"dark"!==r||(this.shouldBeLight=!0);case 12:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},N=T,F=Object(c["a"])(N,R,E,!1,null,"0eb4b940",null),q=F.exports,G=s("ecee"),J={discogsUsername:"",discogsOauthToken:"",discogsOauthSecret:"",collection:[],masters:[]},Y={},z={},H={addMaster:function(t,e){var s=e.master;t.masters.push(s)},setDiscogsName:function(t,e){var s=e.username;t.discogsUsername=s},setDiscogsCollection:function(t,e){var s=e.collection;t.collection=s},addToDiscogsCollection:function(t,e){var s=e.additions;t.collections.push(s)}},K={namespaced:!0,state:J,getters:Y,actions:z,mutations:H},W={colors:[]},X={},Z={},V={setCurrentColors:function(t,e){var s=e.colors;t.colors=s}},Q={namespaced:!0,state:W,getters:X,actions:Z,mutations:V};r["a"].use(w["a"]);var tt=!1,et=new w["a"].Store({modules:{discogs:K,randomvinyl:Q},strict:tt}),st=s("584e"),rt=s("c074"),nt=s("ad3d"),it=s("8c4f");G["c"].add(st["a"],rt["a"],st["c"],st["b"],st["d"],st["e"]),r["a"].component("font-awesome-icon",nt["a"]),r["a"].config.productionTip=!1,r["a"].use(it["a"]);var at=[{path:"/random-album",component:q},{path:"/",component:D},{path:"/listen/:id",component:U}],ot=new it["a"]({routes:at});new r["a"]({store:et,router:ot,render:function(t){return t(u)}}).$mount("#app")},e724:function(t,e,s){},f241:function(t,e,s){},ff89:function(t,e,s){"use strict";var r=s("e724"),n=s.n(r);n.a}});
//# sourceMappingURL=app.5808cea0.js.map